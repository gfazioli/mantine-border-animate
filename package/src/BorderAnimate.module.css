/* ============================================
   KEYFRAMES
   ============================================ */

/* Beam effect - moves along the border */
@keyframes border-animate-beam {
  0% {
    offset-distance: 0%;
  }

  100% {
    offset-distance: 100%;
  }
}

/* Glow variant - pulsating glow */
@keyframes border-animate-glow {
  0%,
  100% {
    opacity: 0;
    filter: blur(var(--border-animate-blur));
  }

  50% {
    opacity: var(--border-animate-opacity);
    filter: blur(calc(var(--border-animate-blur) * 5));
  }
}

/* Pulse variant - scale and opacity pulse */
@keyframes border-animate-pulse {
  0%,
  100% {
    opacity: var(--border-animate-opacity, 1);
    transform: scale(1);
  }

  50% {
    opacity: 0;
    transform: scale(1.02);
  }
}

/* Gradient variant - rotating gradient */
@keyframes border-animate-gradient {
  0% {
    --border-animate-angle: 0deg;
  }

  100% {
    --border-animate-angle: 360deg;
  }
}

/* ============================================
   ROOT
   ============================================ */

.root {
  position: relative;
  display: flex;
  border-radius: calc(var(--border-animate-radius));
}

/* ============================================
   BORDER BASE
   ============================================ */

.border {
  --border-animate-size-xs: 64px;
  --border-animate-size-sm: 128px;
  --border-animate-size-md: 256px;
  --border-animate-size-lg: 320px;
  --border-animate-size-xl: 480px;

  --border-animate-width-xs: 1px;
  --border-animate-width-sm: 2px;
  --border-animate-width-md: 4px;
  --border-animate-width-lg: 6px;
  --border-animate-width-xl: 8px;

  --border-animate-blur-xs: 2px;
  --border-animate-blur-sm: 4px;
  --border-animate-blur-md: 8px;
  --border-animate-blur-lg: 16px;
  --border-animate-blur-xl: 32px;

  --border-animate-size: var(--border-animate-size-md);
  --border-animate-width: var(--border-animate-width-xs);

  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: inherit;
  z-index: var(--border-animate-z-index, 1);
  opacity: var(--border-animate-opacity, 1);

  /* Transparent border to define the width */
  border: calc(var(--border-animate-width)) solid transparent;

  &[data-variant='glow'] {
    z-index: -1;
  }
}

/* Mask: shows only the border area (enabled by default) */
.border[data-with-mask='true'] {
  &:not([data-variant='glow']) {
    /* Standard mask properties - works on Firefox 53+ and modern browsers */
    mask-image: linear-gradient(#fff 0 0), linear-gradient(#fff 0 0);
    mask-clip: content-box, border-box;
    mask-composite: exclude;
  }
}

/* Static position for beam variant when animate is false */
.border[data-animate='false'][data-variant='beam']::after {
  offset-distance: calc(var(--border-animate-static-angle) / 360 * 100%);
}

/* Static angle for gradient variant when animate is false */
.border[data-animate='false'][data-variant='gradient']::after {
  --border-animate-angle: calc(var(--border-animate-static-angle) * 1deg);
}

/* ============================================
   ANIMATION CONTROL
   ============================================ */

/* Disable all animations when data-animate is false */
.border[data-animate='false'] {
  animation: none !important;
}

.border[data-animate='false']::after {
  animation: none !important;
}

/* ============================================
   BEAM VARIANT
   ============================================ */

.border[data-variant='beam']::after {
  content: '';
  position: absolute;
  aspect-ratio: 1;
  width: calc(var(--border-animate-size));

  /* Radial gradient for uniform glow */
  background: radial-gradient(
    ellipse at center,
    var(--border-animate-color-from) 0%,
    var(--border-animate-color-to) 40%,
    transparent 70%
  );

  /* Blur effect */
  filter: blur(var(--border-animate-blur));

  /* Move along the border path - anchor controls inward offset */
  offset-path: rect(
    calc(var(--border-animate-anchor, 0) * 1px) calc(100% - var(--border-animate-anchor, 0) * 1px)
      calc(100% - var(--border-animate-anchor, 0) * 1px) calc(var(--border-animate-anchor, 0) * 1px)
      round calc(var(--border-animate-radius))
  );
  offset-anchor: 50% 50%;

  animation: border-animate-beam var(--border-animate-duration, 5s) linear infinite
    var(--border-animate-direction, normal);
  animation-delay: var(--border-animate-delay, 0s);
}

/* ============================================
   GRADIENT VARIANT
   ============================================ */

@property --border-animate-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

.border[data-variant='gradient']::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  background: conic-gradient(
    from var(--border-animate-angle, 0deg),
    var(--border-animate-color-from),
    var(--border-animate-color-to),
    var(--border-animate-color-from)
  );
  filter: blur(var(--border-animate-blur));

  animation: border-animate-gradient var(--border-animate-duration, 3s) linear infinite
    var(--border-animate-direction, normal);
  animation-delay: var(--border-animate-delay, 0s);
}

/* ============================================
   GLOW VARIANT
   ============================================ */

.border[data-variant='glow']::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  /* Full border glow */
  background: linear-gradient(
    90deg,
    var(--border-animate-color-from),
    var(--border-animate-color-to),
    var(--border-animate-color-from)
  );

  filter: blur(var(--border-animate-blur));

  animation: border-animate-glow var(--border-animate-duration, 2s) ease-in-out infinite
    var(--border-animate-direction, normal);
  animation-delay: var(--border-animate-delay, 0s);
}

/* ============================================
   PULSE VARIANT
   ============================================ */

.border[data-variant='pulse']::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  background: linear-gradient(
    90deg,
    var(--border-animate-color-from),
    var(--border-animate-color-to)
  );

  filter: blur(var(--border-animate-blur));
  transform-origin: center;

  animation: border-animate-pulse var(--border-animate-duration, 2s) ease-in-out infinite
    var(--border-animate-direction, normal);
  animation-delay: var(--border-animate-delay, 0s);
}

/* Static angle for glow variant when animate is false */
.border[data-animate='false'][data-variant='glow']::after {
  background: linear-gradient(
    calc(var(--border-animate-static-angle) * 1deg),
    var(--border-animate-color-from),
    var(--border-animate-color-to),
    var(--border-animate-color-from)
  );
  opacity: var(--border-animate-opacity);
}

/* Static angle for pulse variant when animate is false */
.border[data-animate='false'][data-variant='pulse']::after {
  background: linear-gradient(
    calc(var(--border-animate-static-angle) * 1deg),
    var(--border-animate-color-from),
    var(--border-animate-color-to)
  );
}
